<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="japon, animaux, tourisme, renard, kitsune">      <!-- Mots-clés référencement-->
        <meta name="author" content="audrey">
        <meta name="description" content="Occupe toi de ton renard légendaire : le kitsune.">          
        <link rel="stylesheet" href="../css/fox.css">
        <link rel="icon" type="image/x-icon" href="../img/torii.png">
        <title>Kitsune</title>
    </head>
    <header>
        <div class="logo-container">
            <img src="../img/torii.png" alt="Logo de Nihon no Monogatari" class="logo">
        </div>
        <button class="menu-btn" aria-label="Ouvrir le menu">&#9776;</button>
        <div class="site-name">
            <h1>Nihon no Monogatari</h1>
        </div>
        <div class="login-container">
            <button onclick="location.href='/account/account_passed.html'" class="login-button">Se connecter</button>
        </div>
    </header>
    <script>
        fetch('/me')
          .then(response => response.json())
          .then(data => {
            if (!data.connected) {
              // Redirige vers la page de connexion si non connecté
              window.location.href = '/account/login.html';
            }
          });
    </script>
    <body>
        <!-- Barre de navigation -->
        <nav class="navbar">
            <ul>
                <li><a href="../accueil.html">Accueil</a></li>
                <li><a href="frise.html">Histoire</a></li>
                <li><a href="tourisme.html">Tourisme</a></li>
                <li><a href="fox.html">Kitsune</a></li>
            </ul>
        </nav>

        <main>
            <h1>Prends soin de ton petit kitsune </h1>
            <div id="fox-care-container">
                <img id="fox" src="../img/kitsune/base.gif" alt="Petit renard" />
                <p id="status-message">Que veux-tu faire avec ton kitsune ?</p>
                <p id="affection-level">Niveau d'affection : 0 </p>
                <div id="affinity-container">
                    <img src="../img/heart_empty.png" id="heart1" class="heart">
                    <img src="../img/heart_empty.png" id="heart2" class="heart">
                    <img src="../img/heart_empty.png" id="heart3" class="heart">
                    <img src="../img/heart_empty.png" id="heart4" class="heart">
                    <img src="../img/heart_empty.png" id="heart5" class="heart">
                </div>
                <br>                 

                <div id="actions">
                    <button onclick="feedFox()">Nourrir </button>
                    <button onclick="petFox()">Caresser </button>
                    <button onclick="playWithFox()">Jouer </button>
                    <br>
                    <button onclick="resetAffection()">Réinitialiser</button>
                </div>
            </div>
            
        </main>

        <!-- Pied de page -->
        <footer>
            <p>&copy; 2025 Nihon no Monogatari. Tous droits réservés.</p>
        </footer>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const loginBtn = document.querySelector(".login-btn"); // Assurez-vous que le bouton a la bonne classe
        
                // Vérifier l'état de connexion dès que la page est chargée
                fetch('/me') // Appel à la route '/me' pour vérifier si l'utilisateur est connecté
                    .then(response => response.json())
                    .then(data => {
                        if (data.connected && loginBtn) {
                            loginBtn.addEventListener("click", function(event) {
                                // Si l'utilisateur est déjà connecté, rediriger vers la page de son compte
                                event.preventDefault();
                                window.location.href = '/account/account_passed.html';
                            });
                        } else if (loginBtn) {
                            loginBtn.addEventListener("click", function(event) {
                                // Si l'utilisateur n'est pas connecté, rediriger vers la page de connexion
                                event.preventDefault();
                                window.location.href = '/login.html';
                            });
                        }
                    })
                    .catch(err => console.error('Erreur lors de la vérification de la connexion:', err));
            });
        </script>
        
        <script src="../js/fox.js"></script>
    </body>
</html>
